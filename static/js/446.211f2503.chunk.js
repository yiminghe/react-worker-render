!function(){"use strict";var t={446:function(t,e,n){var o=n(189),a={};function r(t,e){a[t]=e}function i(t){return a[t]}var s=n(635),p=n.n(s);function u(){}var c,l={supportsMutation:!0,appendInitialChild:u,createInstance:u,createTextInstance:u,finalizeInitialChildren:u,getRootHostContext:u,getChildHostContext:u,now:function(){return Date.now()},getPublicInstance:u,prepareForCommit:u,prepareUpdate:u,resetAfterCommit:u,shouldSetTextContent:function(){return!0},appendChild:u,appendChildToContainer:u,commitTextUpdate:u,commitMount:u,commitUpdate:u,insertBefore:u,insertInContainerBefore:u,removeChild:u,removeChildFromContainer:u,resetTextContent:u,clearContainer:u},d=0;function h(){return c||(c=p()(l)),c}var v=function(t){var e=h().createContainer(++d,!1,!1),n={update:function(t){h().updateContainer(t,e,null,null)},unmount:function(){h().updateContainer(null,e,null)}};return n.update(t),n},f=function(){var t;return(t=h()).batchedUpdates.apply(t,arguments)},m=n(870),C=n(951),g=n(976),I=n(591),x=n(337),y=m.createContext({parent:null,app:null}),k=n(347);function S(t){var e;t.componentContext||(t.componentContext={parent:t,app:(null===(e=t.context)||void 0===e?void 0:e.app)||t});return t.componentContext}var b={classWithContext:function(t){t.contextType=y},updateComponentPath:function(t){var e=t.context.parent,n=e.componentChildIndexMap;n.has(t)?t.componentIndex=n.get(t):(t.componentIndex=++e.componentChildIndex,n.set(t,t.componentIndex),t.componentPath="")},getComponentPath:function(t){if(!t.componentPath){var e=t.context.parent;t.componentPath="".concat(b.getComponentPath(e),"-").concat(t.componentIndex)}return t.componentPath},renderWithComponentContext:function(t,e){return t.componentChildIndex=0,t.componentChildIndexMap.clear(),(0,k.jsx)(y.Provider,{value:S(t),children:e})}},M=b,w=n(228),P=n(169),Z={};function j(t){if(Z[t])return Z[t];var e=function(t){(0,I.Z)(n,t);var e=(0,x.Z)(n);function n(){return(0,C.Z)(this,n),e.apply(this,arguments)}return(0,g.Z)(n,[{key:"render",value:function(){return this.props.children}}]),n}(m.Component),n=e;return n.displayName=t,Z[t]=n,n}Object.assign(Z,{Div:j("div"),Link:j("link"),A:j("a")});var O=function(t){(0,I.Z)(n,t);var e=(0,x.Z)(n);function n(){var t;(0,C.Z)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))).onClick=function(){var e,n;null===(e=(n=t.props).onClick)||void 0===e||e.call(n)},t}return(0,g.Z)(n,[{key:"render",value:function(){return(0,k.jsx)("div",(0,o.Z)((0,o.Z)({},this.props),{},{onClick:this.onClick,children:this.props.children}))}}]),n}(m.Component);function N(t){if(D[t])return D[t];var e=function(e){(0,I.Z)(a,e);var n=(0,x.Z)(a);function a(){return(0,C.Z)(this,a),n.apply(this,arguments)}return(0,g.Z)(a,[{key:"render",value:function(){var e=t;return(0,k.jsx)(e,(0,o.Z)({},this.props))}}]),a}(m.Component),n=e;return n.displayName=t,D[t]=n,n}var D={Div:O};Object.assign(D,{A:N("a"),Link:N("link")});var H=function(t){(0,I.Z)(n,t);var e=(0,x.Z)(n);function n(t){var o;return(0,C.Z)(this,n),(o=e.call(this,t)).onChange=function(t){var e={value:t.target.value,seq:o.state.seq+1};o.setState(e),o.props.onChange(e)},o.state={value:t.value,seq:t.seq},o}return(0,g.Z)(n,[{key:"render",value:function(){return(0,k.jsx)("input",{value:this.state.value,onChange:this.onChange})}}],[{key:"getDerivedStateFromProps",value:function(t,e){return t.seq===e.seq&&t.value!==e.value?(t.seq,e.seq,t.value,(0,o.Z)((0,o.Z)({},e),{},{value:t.value})):(t.seq,e.seq,{})}}]),n}(m.Component);H.defaultProps={seq:1};var T=r("input",{render:function(){return(0,k.jsx)(H,{value:this.state.value,seq:this.state.seq,onChange:this.getEventHandle("onChange")})}});function q(){}function U(t){for(var e={},n=0,o=Object.keys(t);n<o.length;n++){var a=o[n],r=t[a];"function"===typeof r?a.match(/^on[A-z]/)&&(e[a]=r.handleName+""):e[a]=r}return e}var F={};function W(t){if(F[t])return F[t];var e=i(t),n=function(n){(0,I.Z)(r,n);var a=(0,x.Z)(r);function r(n){var o;return(0,C.Z)(this,r),(o=a.call(this,n)).componentIndex=0,o.componentPath="",o.componentChildIndex=0,o.componentChildIndexMap=new Map,o.eventHandles={},o.componentSpec=e,o.componentName=t,o.publicInstance={},o.id="",o.getInstanceProps=function(){return o.props},o.callMethod=q,o.getEventHandle=function(t){var e=(0,P.Z)(o).eventHandles,n=o.context.app;return e[t]||(e[t]=function(){for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];var i={componentId:o.id,method:t,args:a};n.postMessage(i)},e.handleName=t),e[t]},o.state={__self:(0,P.Z)(o),state:{}},o.publicInstance=Object.create(e),Object.defineProperty(o.publicInstance,"props",{get:o.getInstanceProps}),Object.defineProperty(o.publicInstance,"state",{get:o.getInstanceState}),o}return(0,g.Z)(r,[{key:"setStateState",value:function(t){this.setState((function(e){var n=e.state;return{state:(0,o.Z)((0,o.Z)({},n),t)}}))}},{key:"getInstanceState",value:function(){return this.state.state}},{key:"getContext",value:function(){return this.context}},{key:"componentDidMount",value:function(){var t;null===(t=e.componentDidMount)||void 0===t||t.call(this.publicInstance)}},{key:"componentDidUpdate",value:function(t,n){var o,a=this.publicInstance;null===(o=e.componentDidUpdate)||void 0===o||o.call(a,t,n.state)}},{key:"componentWillUnmount",value:function(){var t;null===(t=e.componentWillUnmount)||void 0===t||t.call(this.publicInstance),this.getContext().app.removeComponent(this)}},{key:"render",value:function(){var t=e.render.call({nativeComponents:D,props:this.props,state:this.state.state,getEventHandle:this.getEventHandle,getComponent:W});return M.renderWithComponentContext(this,t)}}],[{key:"getDerivedStateFromProps",value:function(t,e){var n=e.__self;M.updateComponentPath(n);var o=n.context.app;if(!n.id){var a=M.getComponentPath(n);if(n.id=o.newComponentsPathIdMap[a],!n.id)throw new Error("Can not find id from path: ".concat(a));return o.addComponent(n),{state:o.newComponentsIdStateMap[n.id]||{}}}return{}}}]),r}(m.Component);n.contextType=y;var a=n;return a.displayName=t,F[t]=a,a}Object.assign(D,{Input:T||W("input")});var E=n(321),_=function(t){(0,I.Z)(n,t);var e=(0,x.Z)(n);function n(t){var o;return(0,C.Z)(this,n),(o=e.call(this,t)).componentIndex=0,o.componentPath="1",o.componentChildIndex=0,o.componentChildIndexMap=new Map,o.newComponentsPathIdMap={},o.componentNameDefaultPropsMap={},o.newComponentsIdStateMap={},o.pendingIdStateMap={},o.components=new Map,o.componentSpec=null,o.onmessage=function(t){var e=JSON.parse(t.data),n=e.newComponentsIdStateMap,a=e.newComponentsPathIdMap,r=e.pendingIdStateMap,i=e.newComponentNameDefaultPropsMap,s=(0,P.Z)(o),p=s.components,u=s.componentNameDefaultPropsMap;Object.assign(u,i);for(var c=0,l=Object.keys(i);c<l.length;c++){var d=l[c];W(d).defaultProps=i[d]}o.newComponentsIdStateMap=n,o.newComponentsPathIdMap=a,E.unstable_batchedUpdates((function(){o.state.inited||o.setState({inited:!0});for(var t=0,e=Object.keys(r);t<e.length;t++){var n=e[t],a=r[n];p.get(n).setStateState(a)}}))},o.setStateState=q,o.props.worker.onmessage=o.onmessage,o.state={inited:!1},o}return(0,g.Z)(n,[{key:"postMessage",value:function(t){this.props.worker.postMessage(JSON.stringify(t))}},{key:"addComponent",value:function(t){this.components.set(t.id,t)}},{key:"removeComponent",value:function(t){this.components.delete(t.id)}},{key:"render",value:function(){if(this.state.inited){var t=W(this.props.entry);return M.renderWithComponentContext(this,(0,k.jsx)(t,{}))}return null}}]),n}(m.Component);M.classWithContext(_);var A=r("input",{getInitialState:function(){return{value:this.props.value,seq:1}},onChange:function(t){var e,n;this.setState(t,!1),null===(e=(n=this.props).onChange)||void 0===e||e.call(n,t.value)},componentDidUpdate:function(t,e){Number.isNaN(this.props.value)&&Number.isNaN(this.state.value)||this.props.value!==this.state.value&&this.setState((0,o.Z)((0,o.Z)({},this.state),{},{value:this.props.value}))},render:function(){return null}}),R={},J=1;function G(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(R[t])return R[t];var n=i(t),a=function(a){(0,I.Z)(i,a);var r=(0,x.Z)(i);function i(o){var a;if((0,C.Z)(this,i),(a=r.call(this,o)).id=void 0,a.componentIndex=0,a.componentPath="",a.componentChildIndex=0,a.componentChildIndexMap=new Map,a.eventHandles=void 0,a.componentSpec=n,a.publicInstance=void 0,a.componentName=t,a.setStateState=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e||(n=!0),a.setState((function(e){var o=e.state,r={};return r="function"===typeof t?{state:t(o)}:{state:t},n&&a.getContext().app.setStateState((0,P.Z)(a),r.state),r}))},a.getInstanceProps=function(){return a.props},a.getInstanceState=function(){return a.state.state},a.getEventHandle=function(t){var e=(0,P.Z)(a).eventHandles;if(e[t])return e[t];var n=a.publicInstance,o=function(){n[t].apply(n,arguments)};return o.handleName=t,e[t]=o,o},a.id="",a.publicInstance=Object.create(n),a.publicInstance.setState=a.setStateState,Object.defineProperty(a.publicInstance,"props",{get:function(){return a.props}}),Object.defineProperty(a.publicInstance,"state",{get:function(){return a.state.state}}),a.eventHandles={},a.state={__self:(0,P.Z)(a),state:{}},n.getInitialState){var s=n.getInitialState.call(a.publicInstance);s&&(a.state.state=s)}return a}return(0,g.Z)(i,[{key:"callMethod",value:function(t,e){var n=this.publicInstance;n[t].apply(n,(0,w.Z)(e))}},{key:"getContext",value:function(){return this.context}},{key:"componentDidMount",value:function(){var t;null===(t=n.componentDidMount)||void 0===t||t.call(this.publicInstance)}},{key:"componentDidUpdate",value:function(t,e){var o,a=this.publicInstance;null===(o=n.componentDidUpdate)||void 0===o||o.call(a,t,e.state)}},{key:"componentWillUnmount",value:function(){var t;null===(t=n.componentWillUnmount)||void 0===t||t.call(this.publicInstance),this.getContext().app.removeComponent(this)}},{key:"render",value:function(){var t=n.render.call({nativeComponents:Z,props:this.props,state:this.state.state,getEventHandle:this.getEventHandle,getComponent:G});return M.renderWithComponentContext(this,t)}}],[{key:"getDerivedStateFromProps",value:function(t,e){var n=e.__self;M.updateComponentPath(n);var a=n.context.app;if(n.id||(n.id=++J+"",a.addComponent(n)),n.componentSpec.getDerivedStateFromProps){var r=(0,o.Z)({},n.state.state),i=n.componentSpec.getDerivedStateFromProps(t,r);return Object.assign(r,i),{state:r}}return{}}}]),i}(m.Component);a.contextType=y,a.defaultProps=n.defaultProps;var r=a;return r.displayName=t,R[t]=r,r}Object.assign(Z,{Input:A||G("input",!0)});var L=function(t){(0,I.Z)(n,t);var e=(0,x.Z)(n);function n(t){var o;return(0,C.Z)(this,n),(o=e.call(this,t)).componentIndex=0,o.componentPath="1",o.componentChildIndex=0,o.componentChildIndexMap=new Map,o.newComponentsPathIdMap={},o.newComponentsIdStateMap={},o.pendingIdStateMap={},o.newComponentIds=new Set,o.components=new Map,o.scheduled=!1,o.componentNameDefaultPropsMap={},o.onmessage=function(t){var e=JSON.parse(t.data),n=e.componentId,a=e.method,r=e.args,i=o.components.get(n);f((function(){i.callMethod(a,r)}))},o.props.worker.onmessage=o.onmessage,o}return(0,g.Z)(n,[{key:"postMessage",value:function(t){this.props.worker.postMessage(JSON.stringify(t))}},{key:"afterSendToRender",value:function(){this.pendingIdStateMap={},this.newComponentIds.clear(),this.newComponentsPathIdMap={},this.newComponentsIdStateMap={}}},{key:"scheduleSendToRender",value:function(){var t=this;this.scheduled||(this.scheduled=!0,Promise.resolve().then((function(){t.sendToRender(),t.afterSendToRender(),t.scheduled=!1})))}},{key:"componentDidMount",value:function(){this.scheduleSendToRender()}},{key:"sendToRender",value:function(){for(var t=this.components,e=this.pendingIdStateMap,n=this.newComponentsIdStateMap,o=this.newComponentsPathIdMap,a=this.componentNameDefaultPropsMap,r={},s=0,p=Object.keys(e);s<p.length;s++){var u=p[s];t.has(u)||delete e[u]}for(var c=0,l=Array.from(this.newComponentIds);c<l.length;c++){var d=l[c],h=t.get(d),v=h.componentName;n[d]=h.getInstanceState(),o[M.getComponentPath(h)]=d,a[v]||(a[v]=i(v).defaultProps||{},r[v]=a[v])}this.postMessage({newComponentsIdStateMap:U(n),newComponentsPathIdMap:o,pendingIdStateMap:U(e),newComponentNameDefaultPropsMap:U(r)})}},{key:"setStateState",value:function(t,e){if(!this.newComponentIds.has(t.id)){var n=this.pendingIdStateMap,o=n[t.id]||{};Object.assign(o,e),n[t.id]=o,this.scheduleSendToRender()}}},{key:"addComponent",value:function(t){this.components.has(t.id)||this.newComponentIds.add(t.id),this.components.set(t.id,t)}},{key:"removeComponent",value:function(t){this.newComponentIds.delete(t.id),this.components.delete(t.id)}},{key:"render",value:function(){var t=G(this.props.entry);return M.renderWithComponentContext(this,(0,k.jsx)(t,{}))}}]),n}(m.Component);M.classWithContext(L);var z=L;var B={getInitialState:function(){return{count:1}},onChange:function(t){var e=parseInt(t);"number"!==typeof e||isNaN(e)||this.setState({count:e})},onClick:function(){this.setState({count:this.state.count+1})}};var K={defaultProps:{defaultId:1},getInitialState:function(){return{now:this.props.defaultId}},refresh:function(){this.setState({now:Date.now()})}};r("app",(0,o.Z)((0,o.Z)({},B),{},{render:function(){var t=this.nativeComponents,e=t.Div,n=t.Input,o=t.Link,a=t.A,r=this.getComponent("title");return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(r,{}),(0,k.jsxs)(e,{children:["set(number):"," ",(0,k.jsx)(n,{onChange:this.getEventHandle("onChange"),value:this.state.count})]}),(0,k.jsxs)(e,{style:{border:"1px solid red",margin:10,padding:10,userSelect:"none"},onClick:this.getEventHandle("onClick"),children:["click to increment: ",this.state.count]}),(0,k.jsx)(o,{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css"}),(0,k.jsx)(e,{children:(0,k.jsx)(a,{className:"github-fork-ribbon",href:"https://github.com/yiminghe/react-worker-render","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub",children:"Fork me on GitHub"})})]})}})),r("title",(0,o.Z)((0,o.Z)({},K),{},{render:function(){var t=this.nativeComponents.Div;return(0,k.jsxs)(t,{style:{border:"1px solid red",padding:10,margin:10,userSelect:"none"},onClick:this.getEventHandle("refresh"),children:["react-worker-render@",this.state.now]})}})),function(t){var e=t.worker,n=t.entry;v((0,k.jsx)(z,{worker:e,entry:n}))}({worker:self,entry:"app"})}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.m=t,n.x=function(){var t=n.O(void 0,[500],(function(){return n(446)}));return t=n.O(t)},function(){var t=[];n.O=function(e,o,a,r){if(!o){var i=1/0;for(c=0;c<t.length;c++){o=t[c][0],a=t[c][1],r=t[c][2];for(var s=!0,p=0;p<o.length;p++)(!1&r||i>=r)&&Object.keys(n.O).every((function(t){return n.O[t](o[p])}))?o.splice(p--,1):(s=!1,r<i&&(i=r));if(s){t.splice(c--,1);var u=a();void 0!==u&&(e=u)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[o,a,r]}}(),n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.f={},n.e=function(t){return Promise.all(Object.keys(n.f).reduce((function(e,o){return n.f[o](t,e),e}),[]))},n.u=function(t){return"static/js/"+t+".3ec42e5b.chunk.js"},n.miniCssF=function(t){},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",function(){var t={446:1};n.f.i=function(e,o){t[e]||importScripts(n.p+n.u(e))};var e=self.webpackChunkexample=self.webpackChunkexample||[],o=e.push.bind(e);e.push=function(e){var a=e[0],r=e[1],i=e[2];for(var s in r)n.o(r,s)&&(n.m[s]=r[s]);for(i&&i(n);a.length;)t[a.pop()]=1;o(e)}}(),function(){var t=n.x;n.x=function(){return n.e(500).then(t)}}();n.x()}();
//# sourceMappingURL=446.211f2503.chunk.js.map