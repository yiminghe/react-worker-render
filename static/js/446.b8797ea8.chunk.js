!function(){"use strict";var e={446:function(e,t,n){var o=n(189),a={};function r(e,t){a[e]=t}function i(e){return a[e]}var s=n(635),p=n.n(s);function u(){}var c,l={supportsMutation:!0,appendInitialChild:u,createInstance:u,createTextInstance:u,finalizeInitialChildren:u,getRootHostContext:u,getChildHostContext:u,now:function(){return Date.now()},getPublicInstance:u,prepareForCommit:u,prepareUpdate:u,resetAfterCommit:u,shouldSetTextContent:function(){return!0},appendChild:u,appendChildToContainer:u,commitTextUpdate:u,commitMount:u,commitUpdate:u,insertBefore:u,insertInContainerBefore:u,removeChild:u,removeChildFromContainer:u,resetTextContent:u,clearContainer:u},d=0;function h(){return c||(c=p()(l)),c}var v=function(e){var t=h().createContainer(++d,!1,!1),n={update:function(e){h().updateContainer(e,t,null,null)},unmount:function(){h().updateContainer(null,t,null)}};return n.update(e),n},f=function(){var e;return(e=h()).batchedUpdates.apply(e,arguments)},m=n(870),C=n(951),g=n(976),I=n(591),x=n(337),y=m.createContext({parent:null,app:null}),k=n(347);function S(e){var t;e.componentContext||(e.componentContext={parent:e,app:(null===(t=e.context)||void 0===t?void 0:t.app)||e});return e.componentContext}var b={classWithContext:function(e){e.contextType=y},updateComponentPath:function(e){var t=e.context.parent,n=t.componentChildIndexMap;n.has(e)?e.componentIndex=n.get(e):(e.componentIndex=++t.componentChildIndex,n.set(e,e.componentIndex),e.componentPath="")},getComponentPath:function(e){if(!e.componentPath){var t=e.context.parent;e.componentPath="".concat(b.getComponentPath(t),"-").concat(e.componentIndex)}return e.componentPath},renderWithComponentContext:function(e,t){return e.componentChildIndex=0,e.componentChildIndexMap.clear(),(0,k.jsx)(y.Provider,{value:S(e),children:t})}},M=b,w=n(228),P=n(169),Z={};function j(e){if(Z[e])return Z[e];var t=function(e){(0,I.Z)(n,e);var t=(0,x.Z)(n);function n(){return(0,C.Z)(this,n),t.apply(this,arguments)}return(0,g.Z)(n,[{key:"render",value:function(){return this.props.children}}]),n}(m.Component),n=t;return n.displayName=e,Z[e]=n,n}Object.assign(Z,{Div:j("div"),Link:j("link"),A:j("a")});var O=function(e){(0,I.Z)(n,e);var t=(0,x.Z)(n);function n(){var e;(0,C.Z)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onClick=function(){var t,n;null===(t=(n=e.props).onClick)||void 0===t||t.call(n)},e}return(0,g.Z)(n,[{key:"render",value:function(){return(0,k.jsx)("div",(0,o.Z)((0,o.Z)({},this.props),{},{onClick:this.onClick,children:this.props.children}))}}]),n}(m.Component);function N(e){if(D[e])return D[e];var t=function(t){(0,I.Z)(a,t);var n=(0,x.Z)(a);function a(){return(0,C.Z)(this,a),n.apply(this,arguments)}return(0,g.Z)(a,[{key:"render",value:function(){var t=e;return(0,k.jsx)(t,(0,o.Z)({},this.props))}}]),a}(m.Component),n=t;return n.displayName=e,D[e]=n,n}var D={Div:O};Object.assign(D,{A:N("a"),Link:N("link")});var H=function(e){(0,I.Z)(n,e);var t=(0,x.Z)(n);function n(e){var o;return(0,C.Z)(this,n),(o=t.call(this,e)).onChange=function(e){var t={value:e.target.value,seq:o.state.seq+1};o.setState(t),o.props.onChange(t)},o.state={value:e.value,seq:e.seq},o}return(0,g.Z)(n,[{key:"render",value:function(){return(0,k.jsx)("input",{value:this.state.value,onChange:this.onChange})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.seq===t.seq&&e.value!==t.value?(e.seq,t.seq,e.value,(0,o.Z)((0,o.Z)({},t),{},{value:e.value})):(e.seq,t.seq,{})}}]),n}(m.Component);H.defaultProps={seq:1};var T=r("input",{render:function(){return(0,k.jsx)(H,{value:this.state.value,seq:this.state.seq,onChange:this.getEventHandle("onChange")})}});function q(){}function U(e){for(var t={},n=0,o=Object.keys(e);n<o.length;n++){var a=o[n],r=e[a];"function"===typeof r?a.match(/^on[A-z]/)&&(t[a]=r.handleName+""):t[a]=r}return t}var F={};function W(e){if(F[e])return F[e];var t=i(e),n=function(n){(0,I.Z)(r,n);var a=(0,x.Z)(r);function r(n){var o;return(0,C.Z)(this,r),(o=a.call(this,n)).componentIndex=0,o.componentPath="",o.componentChildIndex=0,o.componentChildIndexMap=new Map,o.eventHandles={},o.componentSpec=t,o.componentName=e,o.publicInstance={},o.id="",o.getInstanceProps=function(){return o.props},o.callMethod=q,o.getEventHandle=function(e){var t=(0,P.Z)(o).eventHandles,n=o.context.app;return t[e]||(t[e]=function(){for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];var i={componentId:o.id,method:e,args:a};n.postMessage(i)},t.handleName=e),t[e]},o.state={__self:(0,P.Z)(o),state:{}},o.publicInstance=Object.create(t),Object.defineProperty(o.publicInstance,"props",{get:o.getInstanceProps}),Object.defineProperty(o.publicInstance,"state",{get:o.getInstanceState}),o}return(0,g.Z)(r,[{key:"setStateState",value:function(e){this.setState((function(t){var n=t.state;return{state:(0,o.Z)((0,o.Z)({},n),e)}}))}},{key:"getInstanceState",value:function(){return this.state.state}},{key:"getContext",value:function(){return this.context}},{key:"componentDidMount",value:function(){var e;null===(e=t.componentDidMount)||void 0===e||e.call(this.publicInstance)}},{key:"componentDidUpdate",value:function(e,n){var o,a=this.publicInstance;null===(o=t.componentDidUpdate)||void 0===o||o.call(a,e,n.state)}},{key:"componentWillUnmount",value:function(){var e;null===(e=t.componentWillUnmount)||void 0===e||e.call(this.publicInstance),this.getContext().app.removeComponent(this)}},{key:"render",value:function(){var e=t.render.call({nativeComponents:D,props:this.props,state:this.state.state,getEventHandle:this.getEventHandle,getComponent:W});return M.renderWithComponentContext(this,e)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.__self;M.updateComponentPath(n);var o=n.context.app;if(!n.id){var a=M.getComponentPath(n);if(n.id=o.newComponentsPathIdMap[a],!n.id)throw new Error("Can not find id from path: ".concat(a));return o.addComponent(n),{state:o.newComponentsIdStateMap[n.id]||{}}}return{}}}]),r}(m.Component);n.contextType=y;var a=n;return a.displayName=e,F[e]=a,a}Object.assign(D,{Input:T||W("input")});var E=n(321),_=function(e){(0,I.Z)(n,e);var t=(0,x.Z)(n);function n(e){var o;return(0,C.Z)(this,n),(o=t.call(this,e)).componentIndex=0,o.componentPath="1",o.componentChildIndex=0,o.componentChildIndexMap=new Map,o.newComponentsPathIdMap={},o.componentNameDefaultPropsMap={},o.newComponentsIdStateMap={},o.pendingIdStateMap={},o.components=new Map,o.componentSpec=null,o.onmessage=function(e){var t=JSON.parse(e.data),n=t.newComponentsIdStateMap,a=t.newComponentsPathIdMap,r=t.pendingIdStateMap,i=t.newComponentNameDefaultPropsMap,s=(0,P.Z)(o),p=s.components,u=s.componentNameDefaultPropsMap;Object.assign(u,i);for(var c=0,l=Object.keys(i);c<l.length;c++){var d=l[c];W(d).defaultProps=i[d]}o.newComponentsIdStateMap=n,o.newComponentsPathIdMap=a,E.unstable_batchedUpdates((function(){o.state.inited||o.setState({inited:!0});for(var e=0,t=Object.keys(r);e<t.length;e++){var n=t[e],a=r[n];p.get(n).setStateState(a)}}))},o.setStateState=q,o.props.worker.onmessage=o.onmessage,o.state={inited:!1},o}return(0,g.Z)(n,[{key:"postMessage",value:function(e){this.props.worker.postMessage(JSON.stringify(e))}},{key:"addComponent",value:function(e){this.components.set(e.id,e)}},{key:"removeComponent",value:function(e){this.components.delete(e.id)}},{key:"render",value:function(){if(this.state.inited){var e=W(this.props.entry);return M.renderWithComponentContext(this,(0,k.jsx)(e,{}))}return null}}]),n}(m.Component);M.classWithContext(_);var A=r("input",{getInitialState:function(){return{value:this.props.value,seq:1}},onChange:function(e){var t,n;this.setState(e,!1),null===(t=(n=this.props).onChange)||void 0===t||t.call(n,e.value)},componentDidUpdate:function(e,t){Number.isNaN(this.props.value)&&Number.isNaN(this.state.value)||this.props.value!==this.state.value&&this.setState((0,o.Z)((0,o.Z)({},this.state),{},{value:this.props.value}))},render:function(){return null}}),R={},J=1;function G(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(R[e])return R[e];var n=i(e),a=function(a){(0,I.Z)(i,a);var r=(0,x.Z)(i);function i(o){var a;if((0,C.Z)(this,i),(a=r.call(this,o)).id=void 0,a.componentIndex=0,a.componentPath="",a.componentChildIndex=0,a.componentChildIndexMap=new Map,a.eventHandles=void 0,a.componentSpec=n,a.publicInstance=void 0,a.componentName=e,a.setStateState=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t||(n=!0),a.setState((function(t){var o=t.state,r={};return r="function"===typeof e?{state:e(o)}:{state:e},n&&a.getContext().app.setStateState((0,P.Z)(a),r.state),r}))},a.getInstanceProps=function(){return a.props},a.getInstanceState=function(){return a.state.state},a.getEventHandle=function(e){var t=(0,P.Z)(a).eventHandles;if(t[e])return t[e];var n=a.publicInstance,o=function(){n[e].apply(n,arguments)};return o.handleName=e,t[e]=o,o},a.id="",a.publicInstance=Object.create(n),a.publicInstance.setState=a.setStateState,Object.defineProperty(a.publicInstance,"props",{get:function(){return a.props}}),Object.defineProperty(a.publicInstance,"state",{get:function(){return a.state.state}}),a.eventHandles={},a.state={__self:(0,P.Z)(a),state:{}},n.getInitialState){var s=n.getInitialState.call(a.publicInstance);s&&(a.state.state=s)}return a}return(0,g.Z)(i,[{key:"callMethod",value:function(e,t){var n=this.publicInstance;n[e].apply(n,(0,w.Z)(t))}},{key:"getContext",value:function(){return this.context}},{key:"componentDidMount",value:function(){var e;null===(e=n.componentDidMount)||void 0===e||e.call(this.publicInstance)}},{key:"componentDidUpdate",value:function(e,t){var o,a=this.publicInstance;null===(o=n.componentDidUpdate)||void 0===o||o.call(a,e,t.state)}},{key:"componentWillUnmount",value:function(){var e;null===(e=n.componentWillUnmount)||void 0===e||e.call(this.publicInstance),this.getContext().app.removeComponent(this)}},{key:"render",value:function(){var e=n.render.call({nativeComponents:Z,props:this.props,state:this.state.state,getEventHandle:this.getEventHandle,getComponent:G});return M.renderWithComponentContext(this,e)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.__self;M.updateComponentPath(n);var a=n.context.app;if(n.id||(n.id=++J+"",a.addComponent(n)),n.componentSpec.getDerivedStateFromProps){var r=(0,o.Z)({},n.state.state),i=n.componentSpec.getDerivedStateFromProps(e,r);return Object.assign(r,i),{state:r}}return{}}}]),i}(m.Component);a.contextType=y,a.defaultProps=n.defaultProps;var r=a;return r.displayName=e,R[e]=r,r}Object.assign(Z,{Input:A||G("input",!0)});var L=function(e){(0,I.Z)(n,e);var t=(0,x.Z)(n);function n(e){var o;return(0,C.Z)(this,n),(o=t.call(this,e)).componentIndex=0,o.componentPath="1",o.componentChildIndex=0,o.componentChildIndexMap=new Map,o.newComponentsPathIdMap={},o.newComponentsIdStateMap={},o.pendingIdStateMap={},o.newComponentIds=new Set,o.components=new Map,o.scheduled=!1,o.componentNameDefaultPropsMap={},o.onmessage=function(e){var t=JSON.parse(e.data),n=t.componentId,a=t.method,r=t.args,i=o.components.get(n);f((function(){i.callMethod(a,r)}))},o.props.worker.onmessage=o.onmessage,o}return(0,g.Z)(n,[{key:"postMessage",value:function(e){this.props.worker.postMessage(JSON.stringify(e))}},{key:"afterSendToRender",value:function(){this.pendingIdStateMap={},this.newComponentIds.clear(),this.newComponentsPathIdMap={},this.newComponentsIdStateMap={}}},{key:"scheduleSendToRender",value:function(){var e=this;this.scheduled||(this.scheduled=!0,Promise.resolve().then((function(){e.sendToRender(),e.afterSendToRender(),e.scheduled=!1})))}},{key:"componentDidMount",value:function(){this.scheduleSendToRender()}},{key:"sendToRender",value:function(){for(var e=this.components,t=this.pendingIdStateMap,n=this.newComponentsIdStateMap,o=this.newComponentsPathIdMap,a=this.componentNameDefaultPropsMap,r={},s=0,p=Object.keys(t);s<p.length;s++){var u=p[s];e.has(u)||delete t[u]}for(var c=0,l=Array.from(this.newComponentIds);c<l.length;c++){var d=l[c],h=e.get(d),v=h.componentName;n[d]=h.getInstanceState(),o[M.getComponentPath(h)]=d,a[v]||(a[v]=i(v).defaultProps||{},r[v]=a[v])}this.postMessage({newComponentsIdStateMap:U(n),newComponentsPathIdMap:o,pendingIdStateMap:U(t),newComponentNameDefaultPropsMap:U(r)})}},{key:"setStateState",value:function(e,t){if(!this.newComponentIds.has(e.id)){var n=this.pendingIdStateMap,o=n[e.id]||{};Object.assign(o,t),n[e.id]=o,this.scheduleSendToRender()}}},{key:"addComponent",value:function(e){this.components.has(e.id)||this.newComponentIds.add(e.id),this.components.set(e.id,e)}},{key:"removeComponent",value:function(e){this.newComponentIds.delete(e.id),this.components.delete(e.id)}},{key:"render",value:function(){var e=G(this.props.entry);return M.renderWithComponentContext(this,(0,k.jsx)(e,{}))}}]),n}(m.Component);M.classWithContext(L);var z=L;var B={getInitialState:function(){return{count:1}},onChange:function(e){var t=parseInt(e);"number"!==typeof t||isNaN(t)||this.setState({count:t})},onClick:function(){this.setState({count:this.state.count+1})}};var K={defaultProps:{defaultId:1},getInitialState:function(){return{now:this.props.defaultId}},refresh:function(){this.setState({now:Date.now()})}};r("app",(0,o.Z)((0,o.Z)({},B),{},{render:function(){var e=this.nativeComponents,t=e.Div,n=e.Input,o=e.Link,a=e.A,r=this.getComponent("title");return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(r,{}),(0,k.jsxs)(t,{children:["set(number):"," ",(0,k.jsx)(n,{onChange:this.getEventHandle("onChange"),value:this.state.count})]}),(0,k.jsxs)(t,{style:{border:"1px solid red",margin:10,padding:10,userSelect:"none"},onClick:this.getEventHandle("onClick"),children:["click to increment: ",this.state.count]}),(0,k.jsx)(o,{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css"}),(0,k.jsx)(t,{children:(0,k.jsx)(a,{className:"github-fork-ribbon",href:"https://github.com/yiminghe/react-worker-render","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub",children:"Fork me on GitHub"})})]})}})),r("title",(0,o.Z)((0,o.Z)({},K),{},{render:function(){var e=this.nativeComponents.Div;return(0,k.jsxs)(e,{style:{border:"1px solid red",padding:10,margin:10,userSelect:"none"},onClick:this.getEventHandle("refresh"),children:["react-worker-render@",this.state.now]})}})),function(e){var t=e.worker,n=e.entry;v((0,k.jsx)(z,{worker:t,entry:n}))}({worker:self,entry:"app"})}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.m=e,n.x=function(){var e=n.O(void 0,[500],(function(){return n(446)}));return e=n.O(e)},function(){var e=[];n.O=function(t,o,a,r){if(!o){var i=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],r=e[c][2];for(var s=!0,p=0;p<o.length;p++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[p])}))?o.splice(p--,1):(s=!1,r<i&&(i=r));if(s){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,a,r]}}(),n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,o){return n.f[o](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".3ec42e5b.chunk.js"},n.miniCssF=function(e){},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/react-worker-render/",function(){var e={446:1};n.f.i=function(t,o){e[t]||importScripts(n.p+n.u(t))};var t=self.webpackChunkexample=self.webpackChunkexample||[],o=t.push.bind(t);t.push=function(t){var a=t[0],r=t[1],i=t[2];for(var s in r)n.o(r,s)&&(n.m[s]=r[s]);for(i&&i(n);a.length;)e[a.pop()]=1;o(t)}}(),function(){var e=n.x;n.x=function(){return n.e(500).then(e)}}();n.x()}();
//# sourceMappingURL=446.b8797ea8.chunk.js.map